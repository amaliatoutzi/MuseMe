---
timestamp: 'Fri Nov 07 2025 23:29:01 GMT-0500 (Eastern Standard Time)'
parent: '[[../20251107_232901.a3ce86b2.md]]'
content_id: eeb0546b34b6f78c575696ef951f19c722c41e7dbc3616e19d13da663b6bd794
---

# CONCEPT TO IMPLEMENT (authoritative spec; treat “principle” as operational behavior)

## concept **Visit** \[User, Museum]

## concept **Visit** \[User, MuseumId, ExhibitId, VisitEntryId]

**purpose**
capture a user’s personal diary of a museum visit, including the list of exhibits seen, each with a required note, at least one photo, and a rating

**principle**
when a user logs a museum visit and records the exhibits they saw (with a required note, photos, and rating), the visit becomes an editable diary entry owned by that user.

**state**
a set of **Visits** with

* an id **VisitId**
* an owner **User**
* a museum **MuseumId**
* an optional title **String**
* a createdAt **DateTime**
* an updatedAt **DateTime**

a set of **VisitEntries** with

* a visit **VisitId**
* an exhibit **ExhibitId**
* a note **String**
* photoUrls **\[String]** (length ≥ 1)
* a rating **Number** (1–5)
* a loggedAt **DateTime**
* an updatedAt **DateTime**

**actions**
**createVisit**(owner: User, museum: MuseumId, title?: String) : { visitId: VisitId } | { error: String }

* requires owner exists and museum exists
* effects create **Visit(visitId, owner, museum, title?)**; set `createdAt := now`, `updatedAt := now`

**addEntry**(visit: VisitId, exhibit: ExhibitId, note: String, photoUrls: \[String], rating: Number, user: User) : Empty | { error: String }

* requires **Visits\[visit]** exists, `user = Visits[visit].owner`, and exhibit belongs to **Visits\[visit].museum**; `note.trim() !== ""`; `photoUrls.length ≥ 1` after sanitization; `1 ≤ rating ≤ 5`
* effects create **VisitEntries(visitEntryId, visit, exhibit, note, photoUrls, rating, loggedAt := now, updatedAt := now)**; set **Visits\[visit].updatedAt := now**;

**removeEntry**(visitEntryId: VisitEntryId, user: User) : Empty | { error: String }

* requires entry exists and `user = entry.visit.owner`
* effects delete the entire visit associated with `visitEntryId` and all its entries (cascading removal)

**queries**
**Visit?**(visitId: VisitId) : (visit: Visit)

* effects return the visit with the given `visitId`, if it exists

**VisitsByUser**(user: User) : (visit: Visit)

* effects return every visit owned by `user` that has at least one entry, ordered by `updatedAt` descending

**EntriesByVisit**(visitId: VisitId) : (entry: VisitEntry)

* effects return every visit entry for `visitId`, ordered by `loggedAt` ascending

**VisitEntry?**(visitEntryId: VisitEntryId) : (entry: VisitEntry)

* effects return the visit entry with the given `visitEntryId`, if it exists
